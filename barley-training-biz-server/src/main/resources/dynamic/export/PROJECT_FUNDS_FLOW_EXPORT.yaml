sourceType: '#JAVASCRIPT'
script: |
  function value(data) {
    return data == null ? '' : utils.valueToString(data);
  }
  // 读取
  var workbook = excel.readTemplate();
  // 读取sheet 页
  var sheet = workbook.getSheetAt(0);
  
  // 查询数据
  var sql = global.get('DATALIST');
  var dataList = mybatis.query('DEFAULT', sql, params);
  log.info('{}, {}', sql, dataList);
  
  // 写入数据
  for(var p = 0; p < dataList.length; p++) {
    var dataItem = dataList.get(p);
    var row = sheet.getRow(1 + p);
    if (row == null) {
        row = sheet.createRow(1 + p);
    }
    // 表示你有多少列
    for (var i = 0; i < 20; i++ ) {
        if (row.getCell(i) == null) {
            row.createCell(i).setCellValue('');
        }
    }
    row.getCell(0).setCellValue(value(dataItem.get('project_id')));
    row.getCell(1).setCellValue(value(dataItem.get('projectName')));
    row.getCell(2).setCellValue(value(dataItem.get('subjectId')));
    row.getCell(3).setCellValue(value(dataItem.get('subjectName')));
    row.getCell(4).setCellValue(value(dataItem.get('className')));
    row.getCell(5).setCellValue(value(dataItem.get('amount')));
  }
  
  // 保存
  excel.save(workbook);
scriptCount:
config:
  template: 1.xlsx
  DATALIST: |
    SELECT
      t1.id,
      t1.project_id AS project_id,
      t1.project_name AS projectName,
      t1.subject_id AS subjectId,
      t1.subject_name AS subjectName,
      t1.class_name AS className,
      t1.amount,
      t1.transaction_date AS transactionDate,
      t1.transaction_type AS transactionType,
      t1.remarks
    FROM project_funds_flow t1